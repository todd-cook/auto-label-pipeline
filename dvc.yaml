stages:
  fetch:
    cmd:
      - python src/fetch.py --param_group fetch_data
      - python src/fetch.py --param_group fetch_model
    always_changed: True
    deps:
      - src/fetch.py
    params:
      - fetch_data.file
      - fetch_data.uri
      - fetch_model.file
      - fetch_model.uri
  prepare:
    cmd: python src/prepare.py
    deps:
      - src/prepare.py
      - data/raw
    outs:
      - data/prepared/data.all.csv
    metrics:
      - reports/prepare.metrics.json:
          cache: false
    params:
      - fetch_data.file
      - prepare.embeddings_dim
      - prepare.filter_lang_bool
      - prepare.filter_lang
      - prepare.lang_detect_model
      - prepare.stopwords_filter_lang
      - prepare.filter_count_gteq
      - prepare.tfidf_dict_pickle_file
  train:
    cmd: python src/train.py
    deps:
    - data/prepared/data.all.csv
    - src/train.py
    outs:
    - model/svm.model.pkl
    metrics:
    - model/train.metrics.json:
        cache: false
    plots:
    - model/class.metrics.csv:
        cache: false
    params:
    - train.class_types
    - train.svm_degree
    - train.svm_dual
    - train.svm_gamma
    - train.svm_kernel
    - train.svm_loss
    - train.model_type
    - train.svm_penalty
    - train.svm_regularization_C
    - train.seed
    - train.split
    - train.knc_n_neighbors
    - train.knc_weights
    - train.knc_algorithm
    - train.knc_leaf_size
    - train.knc_p
    - train.knc_metric
    - train.num_components
    - train.use_pca
  relabel:
    cmd: python src/relabel.py
    deps:
      - src/relabel.py
      - data/prepared/data.all.csv
      - model/svm.model.pkl
    outs:
      - data/final/data.csv
    metrics:
      - reports/relabel.metrics.json:
          cache: false
    plots:
    - data/final/class.metrics.csv:
        cache: false
    params:
    - prepare.unknown_tag
    - train.class_types
    - train.svm_degree
    - train.svm_dual
    - train.svm_gamma
    - train.svm_kernel
    - train.svm_loss
    - train.model_type
    - train.svm_penalty
    - train.svm_regularization_C
    - train.seed
    - train.split
    - train.knc_n_neighbors
    - train.knc_weights
    - train.knc_algorithm
    - train.knc_leaf_size
    - train.knc_p
    - train.knc_metric
    - relabel.num_crossval_folds
    - relabel.min_distance_decision
    - relabel.max_distance_decision
